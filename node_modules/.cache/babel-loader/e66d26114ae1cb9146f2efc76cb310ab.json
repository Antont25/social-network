{"ast":null,"code":"import { api } from '../api/api';\nimport { setIsLoading } from './appReducer';\nimport { errorFromStatusCodeOrApplication } from '../utils/error-utils';\nconst initialStateUserPage = {\n  items: [],\n  totalCount: 0,\n  pageSize: 10,\n  currentPage: 1,\n  portionsNumber: 1,\n  error: null,\n  userSubscription: []\n};\nexport const usersReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialStateUserPage;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case 'USERS/SET_USERS':\n      return { ...state,\n        items: action.payload.items,\n        totalCount: action.payload.totalCount,\n        error: action.payload.error\n      };\n\n    case 'USERS/FOLLOW':\n      return { ...state,\n        items: state.items.map(item => item.id === action.payload ? { ...item,\n          followed: true\n        } : item)\n      };\n\n    case 'USERS/UN_FOLLOW':\n      return { ...state,\n        items: state.items.map(item => item.id === action.payload ? { ...item,\n          followed: false\n        } : item)\n      };\n\n    case 'USERS/SET_CURRENT_PAGE':\n      return { ...state,\n        currentPage: action.payload\n      };\n\n    case 'USERS/SET_PORTION_NUMBER':\n      return { ...state,\n        portionsNumber: action.payload\n      };\n\n    case 'USERS/ADD_USER_SUBSCRIPTION':\n      return { ...state,\n        userSubscription: action.isFollowing ? [...state.userSubscription, action.userId] : state.userSubscription.filter(item => item !== action.userId)\n      };\n\n    default:\n      return state;\n  }\n}; //action\n\nexport const setUsers = payload => ({\n  type: 'USERS/SET_USERS',\n  payload\n});\nexport const follow = payload => ({\n  type: 'USERS/FOLLOW',\n  payload\n});\nexport const unFollow = payload => ({\n  type: 'USERS/UN_FOLLOW',\n  payload\n});\nexport const setCurrentPage = payload => ({\n  type: 'USERS/SET_CURRENT_PAGE',\n  payload\n});\nexport const setPortionsNumber = payload => ({\n  type: 'USERS/SET_PORTION_NUMBER',\n  payload\n});\nexport const setUserSubscription = (userId, isFollowing) => ({\n  type: 'USERS/ADD_USER_SUBSCRIPTION',\n  userId,\n  isFollowing\n}); //thunk\n\nexport const fetchUserData = currentPage => async dispatch => {\n  try {\n    debugger;\n    dispatch(setIsLoading(true));\n    let response = await api.getUser(currentPage);\n    dispatch(setUsers(response));\n  } catch (e) {\n    const error = e;\n    errorFromStatusCodeOrApplication(error, dispatch);\n  } finally {\n    dispatch(setIsLoading(false));\n  }\n};\nexport const fetchFollowUser = usersId => async dispatch => {\n  try {\n    dispatch(setUserSubscription(usersId, true));\n    let response = await api.followUser(usersId);\n\n    if (response.resultCode === 0) {\n      dispatch(follow(usersId));\n    }\n  } catch (e) {\n    const error = e;\n    errorFromStatusCodeOrApplication(error, dispatch);\n  } finally {\n    dispatch(setUserSubscription(usersId, false));\n  }\n};\nexport const fetchUnFollowUser = usersId => async dispatch => {\n  try {\n    dispatch(setUserSubscription(usersId, true));\n    let response = await api.unFollowUser(usersId);\n\n    if (response.resultCode === 0) {\n      dispatch(unFollow(usersId));\n    }\n  } catch (e) {\n    const error = e;\n    errorFromStatusCodeOrApplication(error, dispatch);\n  } finally {\n    dispatch(setUserSubscription(usersId, false));\n  }\n}; //type","map":{"version":3,"names":["api","setIsLoading","errorFromStatusCodeOrApplication","initialStateUserPage","items","totalCount","pageSize","currentPage","portionsNumber","error","userSubscription","usersReducer","state","action","type","payload","map","item","id","followed","isFollowing","userId","filter","setUsers","follow","unFollow","setCurrentPage","setPortionsNumber","setUserSubscription","fetchUserData","dispatch","response","getUser","e","fetchFollowUser","usersId","followUser","resultCode","fetchUnFollowUser","unFollowUser"],"sources":["G:/program/practica/react-practica/it-incubator/samurai-way-TS/src/redux/usersReducer.ts"],"sourcesContent":["import {api, FetchUserType, UserType} from '../api/api';\r\nimport {setIsLoading} from './appReducer';\r\nimport {AppThunk} from './store';\r\nimport {AxiosError} from 'axios';\r\nimport {errorFromStatusCodeOrApplication} from '../utils/error-utils';\r\n\r\nconst initialStateUserPage = {\r\n    items: [] as Array<UserType>,\r\n    totalCount: 0,\r\n    pageSize: 10,\r\n    currentPage: 1,\r\n    portionsNumber: 1,\r\n    error: null,\r\n    userSubscription: [] as Array<number>\r\n}\r\n\r\nexport const usersReducer = (state = initialStateUserPage, action: ActionUserReducerType): InitialStateUserPageType => {\r\n    switch (action.type) {\r\n        case 'USERS/SET_USERS':\r\n            return {\r\n                ...state,\r\n                items: action.payload.items,\r\n                totalCount: action.payload.totalCount,\r\n                error: action.payload.error\r\n            }\r\n        case 'USERS/FOLLOW':\r\n            return {\r\n                ...state,\r\n                items: state.items.map(item => item.id === action.payload\r\n                    ? {...item, followed: true}\r\n                    : item)\r\n            }\r\n        case 'USERS/UN_FOLLOW':\r\n            return {\r\n                ...state,\r\n                items: state.items.map(item => item.id === action.payload\r\n                    ? {...item, followed: false}\r\n                    : item)\r\n            }\r\n        case 'USERS/SET_CURRENT_PAGE':\r\n            return {\r\n                ...state,\r\n                currentPage: action.payload\r\n            }\r\n        case 'USERS/SET_PORTION_NUMBER':\r\n            return {\r\n                ...state,\r\n                portionsNumber: action.payload\r\n            }\r\n        case 'USERS/ADD_USER_SUBSCRIPTION':\r\n            return {\r\n                ...state,\r\n                userSubscription: action.isFollowing\r\n                    ? [...state.userSubscription, action.userId]\r\n                    : state.userSubscription.filter(item => item !== action.userId)\r\n            }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\n//action\r\nexport const setUsers = (payload: FetchUserType) => ({type: 'USERS/SET_USERS', payload} as const)\r\nexport const follow = (payload: number) => ({type: 'USERS/FOLLOW', payload} as const)\r\nexport const unFollow = (payload: number) => ({type: 'USERS/UN_FOLLOW', payload} as const)\r\nexport const setCurrentPage = (payload: number) => ({type: 'USERS/SET_CURRENT_PAGE', payload} as const)\r\nexport const setPortionsNumber = (payload: number) => ({type: 'USERS/SET_PORTION_NUMBER', payload} as const)\r\nexport const setUserSubscription = (userId: number, isFollowing: boolean) =>\r\n    ({type: 'USERS/ADD_USER_SUBSCRIPTION', userId, isFollowing} as const)\r\n\r\n//thunk\r\nexport const fetchUserData = (currentPage: number): AppThunk => async dispatch => {\r\n    try {\r\n        debugger\r\n        dispatch(setIsLoading(true))\r\n        let response = await api.getUser(currentPage)\r\n        dispatch(setUsers(response))\r\n    } catch (e) {\r\n        const error = e as Error | AxiosError\r\n        errorFromStatusCodeOrApplication(error, dispatch)\r\n    } finally {\r\n        dispatch(setIsLoading(false))\r\n    }\r\n\r\n}\r\nexport const fetchFollowUser = (usersId: number): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setUserSubscription(usersId, true))\r\n        let response = await api.followUser(usersId)\r\n        if (response.resultCode === 0) {\r\n            dispatch(follow(usersId))\r\n        }\r\n    } catch (e) {\r\n        const error = e as Error | AxiosError\r\n        errorFromStatusCodeOrApplication(error, dispatch)\r\n    } finally {\r\n        dispatch(setUserSubscription(usersId, false))\r\n    }\r\n}\r\nexport const fetchUnFollowUser = (usersId: number): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setUserSubscription(usersId, true))\r\n        let response = await api.unFollowUser(usersId)\r\n        if (response.resultCode === 0) {\r\n            dispatch(unFollow(usersId))\r\n        }\r\n    } catch (e) {\r\n        const error = e as Error | AxiosError\r\n        errorFromStatusCodeOrApplication(error, dispatch)\r\n    } finally {\r\n        dispatch(setUserSubscription(usersId, false))\r\n    }\r\n}\r\n\r\n//type\r\nexport type InitialStateUserPageType = {\r\n    items: Array<UserType>\r\n    totalCount: number\r\n    pageSize: number\r\n    currentPage: number\r\n    error: null\r\n    portionsNumber: number\r\n    userSubscription: Array<number>\r\n}\r\nexport type ActionUserReducerType = ReturnType<typeof setUsers>\r\n    | ReturnType<typeof follow>\r\n    | ReturnType<typeof unFollow>\r\n    | ReturnType<typeof setCurrentPage>\r\n    | ReturnType<typeof setPortionsNumber>\r\n    | ReturnType<typeof setUserSubscription>\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}