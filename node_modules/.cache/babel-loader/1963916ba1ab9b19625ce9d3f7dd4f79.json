{"ast":null,"code":"import { api } from \"../api/api\";\nimport { setIsLoading } from \"./authorizedReducer\";\nconst initialStateUserPage = {\n  items: [],\n  totalCount: 0,\n  pageSize: 10,\n  currentPage: 1,\n  portionsNumber: 1,\n  error: null,\n  userSubscription: []\n};\nexport const usersReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialStateUserPage;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case 'SET_USERS':\n      return { ...state,\n        items: action.payload.items,\n        totalCount: action.payload.totalCount,\n        error: action.payload.error\n      };\n\n    case 'FOLLOW':\n      return { ...state,\n        items: state.items.map(item => item.id === action.payload ? { ...item,\n          followed: true\n        } : item)\n      };\n\n    case 'UN_FOLLOW':\n      return { ...state,\n        items: state.items.map(item => item.id === action.payload ? { ...item,\n          followed: false\n        } : item)\n      };\n\n    case 'SET_CURRENT_PAGE':\n      return { ...state,\n        currentPage: action.payload\n      };\n\n    case 'SET_PORTION_NUMBER':\n      return { ...state,\n        portionsNumber: action.payload\n      };\n\n    case 'ADD_USER_SUBSCRIPTION':\n      return { ...state,\n        userSubscription: action.isFollowing ? [...state.userSubscription, action.userId] : state.userSubscription.filter(item => item !== action.userId)\n      };\n\n    default:\n      return state;\n  }\n}; //action\n\nexport const setUsers = payload => ({\n  type: 'SET_USERS',\n  payload\n});\nexport const follow = payload => ({\n  type: 'FOLLOW',\n  payload\n});\nexport const unFollow = payload => ({\n  type: 'UN_FOLLOW',\n  payload\n});\nexport const setCurrentPage = payload => ({\n  type: 'SET_CURRENT_PAGE',\n  payload\n});\nexport const setPortionsNumber = payload => ({\n  type: 'SET_PORTION_NUMBER',\n  payload\n});\nexport const setUserSubscription = (userId, isFollowing) => ({\n  type: 'ADD_USER_SUBSCRIPTION',\n  userId,\n  isFollowing\n}); //thunk\n\nexport const fetchUserData = currentPage => async dispatch => {\n  try {\n    dispatch(setIsLoading(true));\n    let response = await api.getUser(currentPage);\n    dispatch(setUsers(response));\n  } catch (error) {\n    console.log(error);\n  } finally {\n    dispatch(setIsLoading(false));\n  }\n};\nexport const fetchUnFollowUser = usersId => async dispatch => {\n  try {\n    dispatch(setUserSubscription(usersId, true));\n    let response = await api.unFollowUser(usersId);\n\n    if (response.resultCode === 0) {\n      dispatch(unFollow(usersId));\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    dispatch(setUserSubscription(usersId, false));\n  }\n};\nexport const fetchFollowUser = usersId => async dispatch => {\n  try {\n    dispatch(setUserSubscription(usersId, true));\n    let response = await api.followUser(usersId);\n\n    if (response.resultCode === 0) {\n      dispatch(follow(usersId));\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    dispatch(setUserSubscription(usersId, false));\n  }\n};","map":{"version":3,"names":["api","setIsLoading","initialStateUserPage","items","totalCount","pageSize","currentPage","portionsNumber","error","userSubscription","usersReducer","state","action","type","payload","map","item","id","followed","isFollowing","userId","filter","setUsers","follow","unFollow","setCurrentPage","setPortionsNumber","setUserSubscription","fetchUserData","dispatch","response","getUser","console","log","fetchUnFollowUser","usersId","unFollowUser","resultCode","fetchFollowUser","followUser"],"sources":["G:/program/practica/react-practica/it-incubator/samurai-way-TS/src/redux/usersReducer.ts"],"sourcesContent":["import {api, FetchUserType, UserType} from \"../api/api\";\r\nimport {setIsLoading} from \"./authorizedReducer\";\r\nimport {AppThunk} from \"./store\";\r\n\r\nexport type InitialStateUserPageType = {\r\n    items: Array<UserType>\r\n    totalCount: number\r\n    pageSize: number\r\n    currentPage: number\r\n    error: null\r\n    portionsNumber: number\r\n    userSubscription: Array<number>\r\n}\r\n\r\nexport type ActionUserReducerType = ReturnType<typeof setUsers>\r\n    | ReturnType<typeof follow>\r\n    | ReturnType<typeof unFollow>\r\n    | ReturnType<typeof setCurrentPage>\r\n    | ReturnType<typeof setPortionsNumber>\r\n    | ReturnType<typeof setUserSubscription>\r\n\r\n\r\nconst initialStateUserPage = {\r\n    items: [] as Array<UserType>,\r\n    totalCount: 0,\r\n    pageSize: 10,\r\n    currentPage: 1,\r\n    portionsNumber: 1,\r\n    error: null,\r\n    userSubscription: [] as Array<number>\r\n}\r\n\r\n\r\nexport const usersReducer = (state = initialStateUserPage, action: ActionUserReducerType): InitialStateUserPageType => {\r\n    switch (action.type) {\r\n        case 'SET_USERS':\r\n            return {\r\n                ...state,\r\n                items: action.payload.items,\r\n                totalCount: action.payload.totalCount,\r\n                error: action.payload.error\r\n            }\r\n        case 'FOLLOW':\r\n            return {\r\n                ...state,\r\n                items: state.items.map(item => item.id === action.payload\r\n                    ? {...item, followed: true}\r\n                    : item)\r\n            }\r\n        case 'UN_FOLLOW':\r\n            return {\r\n                ...state,\r\n                items: state.items.map(item => item.id === action.payload\r\n                    ? {...item, followed: false}\r\n                    : item)\r\n            }\r\n        case 'SET_CURRENT_PAGE':\r\n            return {\r\n                ...state,\r\n                currentPage: action.payload\r\n            }\r\n        case 'SET_PORTION_NUMBER':\r\n            return {\r\n                ...state,\r\n                portionsNumber: action.payload\r\n            }\r\n        case 'ADD_USER_SUBSCRIPTION':\r\n            return {\r\n                ...state,\r\n                userSubscription: action.isFollowing\r\n                    ? [...state.userSubscription, action.userId]\r\n                    : state.userSubscription.filter(item => item !== action.userId)\r\n            }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\n//action\r\nexport const setUsers = (payload: FetchUserType) => ({type: 'SET_USERS', payload} as const)\r\nexport const follow = (payload: number) => ({type: 'FOLLOW', payload} as const)\r\nexport const unFollow = (payload: number) => ({type: 'UN_FOLLOW', payload} as const)\r\nexport const setCurrentPage = (payload: number) => ({type: 'SET_CURRENT_PAGE', payload} as const)\r\nexport const setPortionsNumber = (payload: number) => ({type: 'SET_PORTION_NUMBER', payload} as const)\r\nexport const setUserSubscription = (userId: number, isFollowing: boolean) =>\r\n    ({type: 'ADD_USER_SUBSCRIPTION', userId, isFollowing} as const)\r\n\r\n//thunk\r\nexport const fetchUserData = (currentPage: number): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setIsLoading(true))\r\n        let response = await api.getUser(currentPage)\r\n        dispatch(setUsers(response))\r\n    } catch (error) {\r\n        console.log(error)\r\n    } finally {\r\n        dispatch(setIsLoading(false))\r\n    }\r\n\r\n}\r\n\r\nexport const fetchUnFollowUser = (usersId: number): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setUserSubscription(usersId, true))\r\n        let response = await api.unFollowUser(usersId)\r\n        if (response.resultCode === 0) {\r\n            dispatch(unFollow(usersId))\r\n        }\r\n    } catch (error) {\r\n        console.log(error)\r\n    } finally {\r\n        dispatch(setUserSubscription(usersId, false))\r\n    }\r\n}\r\nexport const fetchFollowUser = (usersId: number): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setUserSubscription(usersId, true))\r\n        let response = await api.followUser(usersId)\r\n        if (response.resultCode === 0) {\r\n            dispatch(follow(usersId))\r\n        }\r\n    } catch (error) {\r\n        console.log(error)\r\n    } finally {\r\n        dispatch(setUserSubscription(usersId, false))\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}