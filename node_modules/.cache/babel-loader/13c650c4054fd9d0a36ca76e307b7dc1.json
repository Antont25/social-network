{"ast":null,"code":"import { api } from \"../api/api\";\nlet initialState = {\n  isLoading: false,\n  authorizedCode: null,\n  authorizedUser: {\n    id: null,\n    email: null,\n    login: null\n  },\n  authorizedProfileUser: {\n    photos: {\n      small: null\n    }\n  }\n};\nconst IS_LOADING = 'IS_LOADING';\nconst SET_AUTHORIZED_USER = 'SET_AUTHORIZED_USER';\nconst SET_AUTHORIZED_CODE = 'SET_AUTHORIZED_CODE';\nconst SET_AUTHORIZED_PROFILE_USER = 'SET_AUTHORIZED_PROFILE_USER';\nexport const authorizedReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case IS_LOADING:\n      return { ...state,\n        isLoading: action.payload\n      };\n\n    case SET_AUTHORIZED_USER:\n      return { ...state,\n        authorizedUser: { ...action.user\n        }\n      };\n\n    case SET_AUTHORIZED_PROFILE_USER:\n      return { ...state,\n        authorizedProfileUser: action.payload\n      };\n\n    case SET_AUTHORIZED_CODE:\n      return { ...state,\n        authorizedCode: action.payload\n      };\n\n    default:\n      return state;\n  }\n};\nexport const setIsLoading = payload => ({\n  type: IS_LOADING,\n  payload\n});\nexport const setAuthorizedUser = (user, authorizedCode) => ({\n  type: SET_AUTHORIZED_USER,\n  user,\n  authorizedCode\n});\nexport const setAuthorizedCode = payload => ({\n  type: SET_AUTHORIZED_CODE,\n  payload\n});\nexport const setAuthorizedProfileUser = payload => ({\n  type: SET_AUTHORIZED_PROFILE_USER,\n  payload\n});\nexport const fetchAuthorizedData = () => async dispatch => {\n  try {\n    dispatch(setIsLoading(true));\n    let response = await api.authorizedMe();\n\n    if (response.resultCode === 0) {\n      dispatch(setAuthorizedUser(response.data, true));\n      dispatch(setAuthorizedCode(0));\n      let responseUser = await api.getUserProfile(response.data.id);\n      dispatch(setAuthorizedProfileUser(responseUser));\n    } else {\n      dispatch(setAuthorizedCode(1));\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    dispatch(setIsLoading(false));\n  }\n};\nexport const fetchAuthorization = (email, password, setStatus) => async dispatch => {\n  try {\n    dispatch(setIsLoading(true));\n    let response = await api.authorize(email, password);\n\n    if (response.resultCode === 0) {\n      dispatch(fetchAuthorizedData());\n    } else if (response.resultCode !== 0) {\n      setStatus(response.messages[0]);\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    dispatch(setIsLoading(false));\n  }\n};\nexport const fetchLogout = () => async dispatch => {\n  try {\n    dispatch(setIsLoading(true));\n    let response = await api.logout();\n\n    if (response.resultCode === 0) {\n      dispatch(fetchAuthorizedData());\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    dispatch(setIsLoading(false));\n  }\n};","map":{"version":3,"names":["api","initialState","isLoading","authorizedCode","authorizedUser","id","email","login","authorizedProfileUser","photos","small","IS_LOADING","SET_AUTHORIZED_USER","SET_AUTHORIZED_CODE","SET_AUTHORIZED_PROFILE_USER","authorizedReducer","state","action","type","payload","user","setIsLoading","setAuthorizedUser","setAuthorizedCode","setAuthorizedProfileUser","fetchAuthorizedData","dispatch","response","authorizedMe","resultCode","data","responseUser","getUserProfile","error","console","log","fetchAuthorization","password","setStatus","authorize","messages","fetchLogout","logout"],"sources":["G:/program/practica/react-practica/it-incubator/samurai-way-TS/src/redux/authorizedReducer.ts"],"sourcesContent":["import {UserProfileType} from \"./profileReducer\";\r\nimport {api} from \"../api/api\";\r\nimport {AppThunk} from \"./store\";\r\n\r\nexport type AuthorizedUserType = {\r\n    id: null | number\r\n    email: null | string\r\n    login: null | string\r\n\r\n}\r\ntype InitialStateType = typeof initialState\r\nexport type ActionAuthorizedReducerType =\r\n    ReturnType<typeof setIsLoading>\r\n    | ReturnType<typeof setAuthorizedUser>\r\n    | ReturnType<typeof setAuthorizedCode>\r\n    | ReturnType<typeof setAuthorizedProfileUser>\r\n\r\n\r\nlet initialState = {\r\n    isLoading: false,\r\n    authorizedCode: null as null | number,\r\n    authorizedUser: {\r\n        id: null,\r\n        email: null,\r\n        login: null\r\n    } as AuthorizedUserType,\r\n    authorizedProfileUser: {\r\n        photos: {small: null}\r\n    } as UserProfileType,\r\n}\r\n\r\nconst IS_LOADING = 'IS_LOADING'\r\nconst SET_AUTHORIZED_USER = 'SET_AUTHORIZED_USER'\r\nconst SET_AUTHORIZED_CODE = 'SET_AUTHORIZED_CODE'\r\nconst SET_AUTHORIZED_PROFILE_USER = 'SET_AUTHORIZED_PROFILE_USER'\r\n\r\nexport const authorizedReducer = (state = initialState, action: ActionAuthorizedReducerType): InitialStateType => {\r\n    switch (action.type) {\r\n        case IS_LOADING:\r\n            return {\r\n                ...state,\r\n                isLoading: action.payload\r\n            }\r\n        case SET_AUTHORIZED_USER:\r\n            return {\r\n                ...state,\r\n                authorizedUser: {...action.user},\r\n            }\r\n        case SET_AUTHORIZED_PROFILE_USER:\r\n            return {\r\n                ...state,\r\n                authorizedProfileUser: action.payload\r\n            }\r\n        case SET_AUTHORIZED_CODE:\r\n            return {\r\n                ...state,\r\n                authorizedCode: action.payload\r\n            }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\n\r\nexport const setIsLoading = (payload: boolean) => ({type: IS_LOADING, payload}) as const\r\nexport const setAuthorizedUser = (user: AuthorizedUserType, authorizedCode: boolean) => ({\r\n    type: SET_AUTHORIZED_USER,\r\n    user,\r\n    authorizedCode\r\n}) as const\r\nexport const setAuthorizedCode = (payload: number) => ({type: SET_AUTHORIZED_CODE, payload}) as const\r\nexport const setAuthorizedProfileUser = (payload: UserProfileType) => ({\r\n    type: SET_AUTHORIZED_PROFILE_USER,\r\n    payload\r\n}) as const\r\n\r\n\r\nexport const fetchAuthorizedData = (): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setIsLoading(true))\r\n        let response = await api.authorizedMe()\r\n        if (response.resultCode === 0) {\r\n            dispatch(setAuthorizedUser(response.data, true))\r\n            dispatch(setAuthorizedCode(0))\r\n            let responseUser = await api.getUserProfile(response.data.id)\r\n            dispatch(setAuthorizedProfileUser(responseUser))\r\n        } else {\r\n            dispatch(setAuthorizedCode(1))\r\n        }\r\n    } catch (error) {\r\n        console.log(error)\r\n    } finally {\r\n        dispatch(setIsLoading(false))\r\n    }\r\n}\r\n\r\nexport const fetchAuthorization = (email: string, password: string, setStatus: any): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setIsLoading(true))\r\n        let response = await api.authorize(email, password)\r\n        if (response.resultCode === 0) {\r\n            dispatch(fetchAuthorizedData())\r\n        } else if (response.resultCode !== 0) {\r\n            setStatus(response.messages[0])\r\n        }\r\n    } catch (error) {\r\n        console.log(error)\r\n    } finally {\r\n        dispatch(setIsLoading(false))\r\n    }\r\n}\r\nexport const fetchLogout = (): AppThunk => async dispatch => {\r\n    try {\r\n        dispatch(setIsLoading(true))\r\n        let response = await api.logout()\r\n        if (response.resultCode === 0) {\r\n            dispatch(fetchAuthorizedData())\r\n        }\r\n    } catch (error) {\r\n        console.log(error)\r\n    } finally {\r\n        dispatch(setIsLoading(false))\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}